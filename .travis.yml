language: node_js
node_js:
- stable
cache:
  directories:
  - node_modules
before_script:
- echo $TRAVIS_TAG
- echo $(git describe --abbrev=0 --tags)
- bash scripts/deploy.sh $TRAVIS_BRANCH
script:
- npm test
- npm run build
deploy:
- provider: s3
  access_key_id: "$AWS_ACCESS_KEY_ID"
  secret_access_key: "$AWS_SECRET_ACCESS_KEY"
  bucket: "$PROD_AWS_BUCKET_NAME"
  local-dir: build
  skip_cleanup: true
  on:
    repo: ahdeshmukh/react-shopping-cart
    branch: master
after_deploy:
- aws configure set preview.cloudfront true
- test $TRAVIS_BRANCH = "master" && aws cloudfront create-invalidation --distribution-id $PROD_AWS_CLOUDFRONT_DISTRIBUTION_ID --paths "/*"
env:
  global:
  - secure: Jo5g/731Qj1Xb/v0kwVshg/gwZXAJU76Q54X9F+tqZjnB/s9LAdKHTvqJl3b8nDGXRuWDpgXZ7vxAzZ7zt5iIkJ5TPAvyV03/UIXtuZ4UuS273HYjUGL1DsiHf1iFijfnrvoJVQVjld92gb7PIzb4opEWQGdS3e1LQ3a8/MAQA5C7NpmmZXoR4/cl5mecv3PEqG/b7hydpAlpcSefo8YauApbd+esUwT2kRSxATJ6sQMr4kz59UbAD3GlxqNVLdDTqSnPK22ou68A+4Rg32n2pbPLn5pwLkav8Ic8tG2z42Iqz9XZptun/0rOhJBzEZwD32d7m8EFmfsF4tXpMKjUwsHmQ9173yoWYqCPYUqRz/JAZO6Ta6li3zW12ckAlNxZVi/NIXpz4YE8UcgctnDzXtVwqNl4hFHcFefFDmPksugiIMMBVd6HUw45DbP3HtC9l6OqqLfTRWHx/kLfyYHkPdh8AXzyYLMPMI393Ay2oohYy63Uhl5R9xQxHTGflc3O10AjydoCOpWd64JHZRXPRdn70fJYvwgUGqHZFoqb5RDp+iHYub6oHQm7hv9bupbUQLfmWH0W5UbHVhZnZqP0na4wsfzfpLwhRmwelk85sQnWd+gSVZkpriibdZphanF0saS0UfoE5AeTDGBTpG1zEL2mA2q32YV7Msotc02Up8=
  - secure: 1IWe0qTuDhotiSfN94zWveRsoLIH7dv0/IdIvyxo2/ULL15iKv76jMybDlIHBH37tPHAATiCNQzZmWe4ZnPPew5wv2L4KCdaP1vTEUvKrJi5ZvRPOJQfScTHvyd+/QBybFEUc76tSywk/0mPxGG4R4yY+ZUyHz1/hpY1IpsKwXytTMH8o2J/qxJeq+0R1RqNOt3mQdHsRKvWP1nHDCFAQS6AyQGLBYPWF2bO+6SoN/Pg1Nyi6I7MQ/P93JnVWaJ21smT0ZLf7P3FehAtlmdIOpiblQn/6ZQtu1gGvMvuvfarVwb7haDBSFTtvbBQUfxzIqFD91LN5JdwX8byhPXe/zI8/F1lTKpRaKNfN4tpvfGaAnsAh8/g8WSYH9iIAfctcZATJE1P/UAQX8koWi/ubbBnY+LRDskHMn5kBtWy8X7M2UAerDQGIzNrFOgzZIxVFsBDD+yxMIv1xiHoP3WwaffmutMNaT2T4pqJ3+pcUhpwa9OdygvvUrkD0LE3rrBEwDQeV16shrcbO7+4YijWH1NttbC33AP2iHzHbloLXMfgA/yLVMnPmhwxUFj8BSTH/UchDamF4fH48MkPQk05q3DAhG88mJhL4MAo4uzNVQOralWLqF21wF5ltl6i3bh8ThsKNbEJQJ8jD/FMOGNZ1X0rk+7YjtYCy1CYAyYof40=
  - secure: Kd3LQt6YVLVR0KyAQQClnF/VSYYNcLrQiVmpsnQWv9gxmcM5o8i/ZmxFDpbT6DbFsV9hGWNWPCQbbc9AiWaq4p2cjlVNYAQ4MuMxsTDusNSNhi88YeMIfGSVpl3tmcnN0YkBK/UVEm3E93L2sc/I/ucJOgOBq2CHrlaS4Q/rR5a6VNy75/MOD3k/p2eZ15yCuXRPyoe38EKgfTAkPfLu0JDNX3lT+/NiEl8uCn487oV7uA4zi5iiHQrakMPxZ/QVspla/iGWaZE0D1YBH1TKujwRuu8ohHehNT7nZDHg/oRyXVMcT8Jr10FGcnvW/a5VV4DNbV5g/roj6sMGRIchUvFpR7oXLjfJlizd0cd9MsPR42Sl/GBe3uYkTfX0Vvj7H/sq9phoy5QBAPu3VvwaEENKVRLoGlk2uIxVT7AS7Ckm8t4YQiuADpfS8tnTyU831pusnJ7xrqdu9Zj/PIA9KEyjiYlbdzTfGZ9ZVqfPsl34zM7yluSKIJiV5AOVqstoN23gXRAwFlf4LvTts6cASKjdUQYvPgKgMwc9tr2ttRRmRP3TAHnKgROSMZCqybAnf/qd6Z6G1lBcodaHFeY8NXhMvZs/9MLkP0tZxVlqKXzfu+LDn66hlWuYaw77HXbfX6HD0SFJJkQlTEh5aOIDLuqtwaKuqemzg2EjfCFy4dY=
  - secure: BJ8N+egg2lhN435T3Cg7BJr/hjDuQgEC9HGmQ0Tf++6JBXD2s9fJXpqlvDgCI/Y3vVFZ+Cd1fNttdjnLqtbXtHGqiIpFn8T0CNxcRqHlyb//qVR+JfiXv75CX1tbtSeSZysoAfJBjWv80mBvDpRxkzqsZHSL1vISfyVudZh19TLguIdYUxdYxO9Vto5SUE0oFZlTpMRe70+aAo7Ezn4PpHLUXYBcizvJvlxC3jI/3RnBKLsrQp/k8prNmcDX6AL9fK46c5wnb4WG3lvFWz6bD66PSoenbC71FOn/LBcZQADx5M4v9Q8zIvxcdrxisXRGC5FmEeSFrsbQqCb0YBNuYtDwhRv/WMs7XZeAE4iQy4dx53Ps6MapA3Ug6nJY17ez2kCFrUk/CnR/7FyoDTQ5+NAA182PjvyQWKR781sw1GL6REp3RpuCdQIAupOelsrbAHfBiclAAkRHI69fwuvIMBmix2iRp54cD8j9zSwxcQcbEj1yDM3c0/mI/Vs/IKGOrEvWx3AO/ayia1ExTKi7FWvI4uhtd3qhpILoikqAOxD2wit7lLnoxsx1M0sVzNtTWUfUtL0uE8LvYfOCJv9jawkN3OCwpRnx0jGJwdw5JGDSzgbc4OBIWI5f2eCjx7G8DRCsf5Xn4xKUKFQUe8hqNP85JOWTAvcaO1PSSr2HBKU=
  - secure: PqNj2o08n9LPuDq6Ox0Rf8MRL0S+/tOKbjmTI2IpuaTekDHiOw8X89hN8rPrt4gXAzATW2d7wxj/iAUgTh5+l03xOUeo4Q0wyTa7LWv4iwxBz1YsXoLbSDDr4C7vR6R7wKtbkLkD7q9ORZQRWZ8ZwsaGXG1X0ZIDHlTpNY6WtxBrL12AN5hjnXq4bpplVodOKQyzSz7l6Ympi91G9AfeOaxdfHlSsJvJumbInT00peQNuWzCWPKtJvz+5vpq1Qrt2W2sicYplTPlG337HqotgXqH3+Jr64v17PjCDW7hGcPlJRuJGJIA/ksDr/ppUfgihhA0bsW/vUOZHVCQdmGY00yHEmEx88UfpaX73twI9K1T7dVmAvXBdj6YZMK92l8hRalJ9b7VIkZSHuXx+l9Jo3GAoyL3nr87cPUYioq1JCR/e8Z7dRY5DBDJaz4TB6bQhxPqxaK21bGuKS7R9BJ8w0lIvkvKGefQWBGZP6vfiZCArMeCy2AjIoBz9cI20z3qc0TKsVTZGusgpsbKnOqW8GLvSqhJyvRIxM+YTiCc85566BHXAC29vLaiSlT+6U6H/begNOw14wUWGheMhU1hzS4HW62BGnPiMorWQMk59PS0j/IsITCBzqT4qi0pAKn9AMFdkYZtn3s+X1Uh+CKNcwRCfdQsMDlRnvwXpENO62I=
